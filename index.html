<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTV Trivia LIVE - ×—×Ÿ ××œ×¨×•××™</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #00f2ff; --secondary: #7000ff; --correct: #00ff88; --wrong: #ff0055; --bg: #050505; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { width: 95%; max-width: 500px; background: rgba(255,255,255,0.05); backdrop-filter: blur(20px); padding: 25px; border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .btn { background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.1); color: white; padding: 15px; border-radius: 12px; cursor: pointer; transition: 0.3s; width: 100%; margin-bottom: 8px; font-weight: bold; }
        .btn:active { transform: scale(0.98); }
        .correct { background: var(--correct) !important; color: black !important; box-shadow: 0 0 15px var(--correct); }
        .wrong { background: var(--wrong) !important; box-shadow: 0 0 15px var(--wrong); }
        #leaderboard { background: rgba(0,0,0,0.4); padding: 15px; border-radius: 15px; margin-bottom: 20px; font-size: 0.9rem; border: 1px solid var(--secondary); }
        .player-row { display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .visualizer { width: 80px; height: 80px; border: 3px solid var(--primary); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 30px; box-shadow: 0 0 15px var(--primary); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        input { width: 80%; padding: 15px; margin-bottom: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.1); color: white; text-align: center; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container" id="setup">
    <h1>ğŸ§ MTV Trivia LIVE</h1>
    <p>×§×¨×‘ ××•×—×•×ª: 60s, 70s, 90s, 2000s</p>
    <input type="text" id="username" placeholder="×”×©× ×©×œ×š...">
    <button class="btn" style="background:var(--primary); color:black;" onclick="joinGame()">×”×¦×˜×¨×£ ×œ××©×—×§</button>
</div>

<div class="container hidden" id="game">
    <div id="leaderboard"></div>
    <div class="visualizer">ğŸ¶</div>
    <h2 id="q-text">×‘××™×–×• ×©× ×” ×™×¦× ×”×©×™×¨?</h2>
    <div id="options"></div>
    <div id="status" style="color:var(--primary); margin-top:10px; font-weight: bold;"></div>
</div>

<audio id="player" crossorigin="anonymous"></audio>

<script>
    // ×”×’×“×¨×•×ª Firebase ×”××¢×•×“×›× ×•×ª ×œ×¤×™ ×”×©×¨×ª ×‘×‘×œ×’×™×”
    const firebaseConfig = {
        apiKey: "AIzaSyBSG7iAfYUCeCTqR3S5LrwmW8YoTjok9hM",
        authDomain: "music-trivia-90e88.firebaseapp.com",
        projectId: "music-trivia-90e88",
        databaseURL: "https://music-trivia-90e88-default-rtdb.europe-west1.firebasedatabase.app/", 
        storageBucket: "music-trivia-90e88.firebasestorage.app",
        messagingSenderId: "202068722806",
        appId: "1:202068722806:web:93d9c6dac3695e8048cb57",
        measurementId: "G-FZPJ6VLBMS"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const audio = document.getElementById('player');
    let myName = "";

    // ×¤×œ×™×™×œ×™×¡×˜ MTV ××’×•×•×Ÿ: ×¨××¤, ×“×× ×¡ ×•× ×•×¡×˜×œ×’×™×”
    const songs = [
        { name: "The Beatles - Let It Be", year: 1970, url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" },
        { name: "Queen - We Will Rock You", year: 1977, url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" },
        { name: "Snap! - Rhythm is a Dancer", year: 1992, url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3" },
        { name: "Dr. Dre - Still D.R.E.", year: 1999, url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3" },
        { name: "Coolio - Gangsta's Paradise", year: 1995, url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3" },
        { name: "Eminem - Lose Yourself", year: 2002, url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3" },
        { name: "Abba - Mamma Mia", year: 1975, url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3" }
    ];

    function joinGame() {
        myName = document.getElementById('username').value;
        if (!myName) return alert("×× × ×”×›× ×¡ ×©×");
        document.getElementById('setup').classList.add('hidden');
        document.getElementById('game').classList.remove('hidden');
        
        // ××ª×—×•×œ × ×™×§×•×“ ×”×©×—×§×Ÿ ×‘×©×¨×ª
        db.ref('players/' + myName).set({ score: 0 });
        initMultiplayer();
    }

    function initMultiplayer() {
        // ×¢×“×›×•×Ÿ ×˜×‘×œ×ª ×©×™××™× ×—×™×” ×œ×›×•×œ×
        db.ref('players').on('value', snap => {
            const data = snap.val();
            let html = "<strong>ğŸ† ×˜×‘×œ×ª ×©×™××™× (LIVE):</strong>";
            for (let p in data) {
                html += `<div class="player-row"><span>${p}</span><span>${data[p].score} × ×§'</span></div>`;
            }
            document.getElementById('leaderboard').innerHTML = html;
        });

        // ×¡× ×›×¨×•×Ÿ ×”×©××œ×” ×”× ×•×›×—×™×ª ×‘×™×Ÿ ×›×œ ×”×©×—×§× ×™×
        db.ref('currentQ').on('value', snap => {
            const qIdx = snap.val();
            if (qIdx === null) {
                db.ref('currentQ').set(0); // ××ª×—×•×œ ×× ×”×©×¨×ª ×¨×™×§
            } else {
                loadQuestion(qIdx);
            }
        });
    }

    function loadQuestion(idx) {
        const q = songs[idx % songs.length];
        const optionsDiv = document.getElementById('options');
        optionsDiv.innerHTML = "";
        document.getElementById('status').innerText = "";
        
        audio.src = q.url;
        audio.play().catch(() => document.getElementById('status').innerText = "ğŸ”Š ×’×¢ ×‘××¡×š ×œ×”×¤×¢×œ×ª ×¡××•× ×“");

        // ×™×¦×™×¨×ª ×ª×©×•×‘×•×ª ×¨× ×“×•××œ×™×•×ª ××¡×‘×™×‘ ×œ×©× ×” ×”× ×›×•× ×”
        const years = [q.year, q.year-4, q.year+2, q.year+7].sort(() => Math.random() - 0.5);
        years.forEach(y => {
            const b = document.createElement('button');
            b.className = 'btn';
            b.innerText = y;
            b.onclick = () => check(y, q.year, b);
            optionsDiv.appendChild(b);
        });
    }

    function check(selected, correct, btn) {
        const btns = document.querySelectorAll('.btn');
        btns.forEach(b => b.onclick = null); // ×× ×™×¢×ª ×œ×—×™×¦×•×ª ×›×¤×•×œ×•×ª

        if (selected == correct) {
            btn.classList.add('correct');
            document.getElementById('status').innerText = "ğŸ¯ ×¤×’×™×¢×” ×‘×•×œ!";
            // ×¢×“×›×•×Ÿ × ×™×§×•×“ ×‘×©×¨×ª
            db.ref('players/' + myName + '/score').transaction(s => (s || 0) + 10);
            setTimeout(() => db.ref('currentQ').transaction(q => q + 1), 2000);
        } else {
            btn.classList.add('wrong');
            document.getElementById('status').innerText = "âŒ ×˜×¢×•×ª! ×”×ª×©×•×‘×” ×”×™× " + correct;
            btns.forEach(b => { if(b.innerText == correct) b.classList.add('correct'); });
            setTimeout(() => db.ref('currentQ').transaction(q => q + 1), 3000);
        }
    }

    // ×”×¤×¢×œ×” ×›×¤×•×™×” ×©×œ ×¡××•× ×“ ×œ× ×™×™×“×™×
    document.body.onclick = () => { audio.play(); };
</script>
</body>
</html>
